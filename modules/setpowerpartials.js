"use strict";
var moment = require('moment-timezone');
var Promise = require("bluebird");
var _ = require("lodash");
var async = require('asyncawait/async');
var await = require('asyncawait/await');
var PouchDB = require('pouchdb');
var config = require('../conf.json');
var localdb = 'data';
function check_day(data, timezone, localdb, partialsdb) {
    return new Promise(function (resolve, reject) {
        var localDB = new PouchDB(localdb);
        var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_day', { auto_compaction: true });
        var dateDay = parseInt(data.date[6] + data.date[7]);
        var dateMonth = parseInt(data.date[4] + data.date[5]);
        var dateforYear = parseInt(data.date[0] + data.date[1] + data.date[2] + data.date[3]);
        var dateBeginningOfDay = moment.tz(dateforYear + ' ' + dateMonth + ' ' + dateDay, "YYYY MM DD", timezone).valueOf();
        var dateBeginningOfMonth = moment.tz(dateforYear + ' ' + dateMonth + ' 01', "YYYY MM DD", timezone).valueOf();
        var dateBeginningOfYear = moment.tz(dateforYear + ' 01 01', "YYYY MM DD", timezone).valueOf();
        var dateforDay = parseInt(dateforYear + data.date[4] + data.date[5] + data.date[6] + data.date[7]);
        var dateforMonth = parseInt(dateforYear + data.date[4] + data.date[5]);
        partialsDB.get('daily_' + data.uid).then(function (dayPower) {
            if (dayPower.dateBeginningOfDay != dateBeginningOfDay) {
                var dailynew = {
                    _id: 'daily_' + data.uid + '_' + dayPower.dateforDay,
                    power: dayPower.power,
                    updatedAt: dayPower.dateBeginningOfDay
                };
                localDB.put(dailynew).then(function (doc) {
                    console.log(doc);
                    dayPower.power = data.dailyEnergy;
                    dayPower.dateBeginningOfDay = dateBeginningOfDay;
                    dayPower.dateforDay = dateforDay;
                    partialsDB.destroy().then(function () {
                        var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_day', { auto_compaction: true });
                        delete dayPower._rev;
                        partialsDB.put(dayPower).then(function () {
                            resolve(true);
                        }).catch(function (err) {
                            console.log(err, "error", "save daily");
                            reject(err);
                        });
                    });
                }).catch(function (err) {
                    reject(err);
                });
            }
            else {
                dayPower.power = data.dailyEnergy;
                dayPower.dateBeginningOfDay = dateBeginningOfDay;
                dayPower.dateforDay = dateforDay;
                partialsDB.destroy().then(function () {
                    var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_day', { auto_compaction: true });
                    delete dayPower._rev;
                    partialsDB.put(dayPower).then(function () {
                        resolve(true);
                    }).catch(function (err) {
                        console.log(err, "error", "save daily partial");
                        reject(err);
                    });
                });
            }
        }).catch(function () {
            var daily = {
                _id: 'daily_' + data.uid,
                dateBeginningOfDay: dateBeginningOfDay,
                power: data.dailyEnergy,
                dateforDay: dateforDay
            };
            partialsDB.put(daily).then(function () {
                resolve(true);
            }).catch(function (err) {
                console.log(err, "error", "save first daily");
                reject(err);
            });
        });
    });
}
function check_month(data, timezone, localdb, partialsdb) {
    return new Promise(function (resolve, reject) {
        var localDB = PouchDB(localdb);
        var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_month', { auto_compaction: true });
        var dateDay = parseInt(data.date[6] + data.date[7]);
        var dateMonth = parseInt(data.date[4] + data.date[5]);
        var dateforYear = parseInt(data.date[0] + data.date[1] + data.date[2] + data.date[3]);
        var dateBeginningOfDay = moment.tz(dateforYear + ' ' + dateMonth + ' ' + dateDay, "YYYY MM DD", timezone).valueOf();
        var dateBeginningOfMonth = moment.tz(dateforYear + ' ' + dateMonth + ' 01', "YYYY MM DD", timezone).valueOf();
        var dateBeginningOfYear = moment.tz(dateforYear + ' 01 01', "YYYY MM DD", timezone).valueOf();
        var dateforDay = parseInt(dateforYear + data.date[4] + data.date[5] + dateDay);
        var dateforMonth = parseInt(dateforYear + data.date[4] + data.date[5]);
        partialsDB.get('monthly_' + data.uid).then(function (monthPower) {
            if (monthPower.dateBeginningOfMonth != dateBeginningOfMonth) {
                var monthlynew = {
                    _id: 'monthly_' + data.uid + '_' + monthPower.dateforMonth,
                    power: monthPower.power,
                    updatedAt: monthPower.dateBeginningOfMonth
                };
                localDB.put(monthlynew).then(function (doc) {
                    monthPower.power = data.monthlyEnergy;
                    monthPower.dateBeginningOfMonth = dateBeginningOfMonth;
                    monthPower.dateforMonth = dateforMonth;
                    partialsDB.destroy().then(function () {
                        var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_month', { auto_compaction: true });
                        delete monthPower._rev;
                        partialsDB.put(monthPower).then(function () {
                            resolve(true);
                        }).catch(function (err) {
                            reject(err);
                        });
                    });
                }).catch(function (err) {
                    reject(err);
                });
            }
            else {
                monthPower.power = data.monthlyEnergy;
                monthPower.dateBeginningOfMonth = dateBeginningOfMonth;
                monthPower.dateforMonth = dateforMonth;
                partialsDB.destroy().then(function () {
                    var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_month', { auto_compaction: true });
                    delete monthPower._rev;
                    partialsDB.put(monthPower).then(function () {
                        resolve(true);
                    }).catch(function (err) {
                        reject(err);
                    });
                });
            }
        }).catch(function () {
            var monthly = {
                _id: 'monthly_' + data.uid,
                dateBeginningOfMonth: dateBeginningOfMonth,
                power: data.monthlyEnergy,
                dateforMonth: dateforMonth
            };
            partialsDB.put(monthly).then(function () {
                resolve(true);
            }).catch(function (err) {
                reject(err);
            });
        });
    });
}
function check_year(data, timezone, localdb, partialsdb) {
    return new Promise(function (resolve, reject) {
        var localDB = PouchDB(localdb);
        var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_year', { auto_compaction: true });
        var dateDay = parseInt(data.date[6] + data.date[7]);
        var dateMonth = parseInt(data.date[4] + data.date[5]);
        var dateforYear = parseInt(data.date[0] + data.date[1] + data.date[2] + data.date[3]);
        var dateBeginningOfDay = moment.tz(dateforYear + ' ' + dateMonth + ' ' + dateDay, "YYYY MM DD", timezone).valueOf();
        var dateBeginningOfMonth = moment.tz(dateforYear + ' ' + dateMonth + ' 01', "YYYY MM DD", timezone).valueOf();
        var dateBeginningOfYear = moment.tz(dateforYear + ' 01 01', "YYYY MM DD", timezone).valueOf();
        var dateforDay = parseInt(dateforYear + data.date[4] + data.date[5] + dateDay);
        var dateforMonth = parseInt(dateforYear + data.date[4] + data.date[5]);
        partialsDB.get('yearly_' + data.uid).then(function (yearPower) {
            if (yearPower.dateBeginningOfYear != dateBeginningOfYear) {
                var yearlynew = {
                    _id: 'yearly_' + data.uid + '_' + yearPower.dateforYear,
                    power: yearPower.power,
                    updatedAt: yearPower.dateBeginningOfYear
                };
                localDB.put(yearlynew).then(function (doc) {
                    yearPower.power = data.yearlyEnergy;
                    yearPower.dateBeginningOfYear = dateBeginningOfYear;
                    yearPower.dateforYear = dateforYear;
                    partialsDB.destroy().then(function () {
                        var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_year', { auto_compaction: true });
                        delete yearPower._rev;
                        partialsDB.put(yearPower).then(function () {
                            resolve(true);
                        }).catch(function (err) {
                            reject(err);
                        });
                    });
                }).catch(function (err) {
                    reject(err);
                });
            }
            else {
                yearPower.power = data.yearlyEnergy;
                yearPower.dateBeginningOfYear = dateBeginningOfYear;
                yearPower.dateforYear = dateforYear;
                partialsDB.destroy().then(function () {
                    var partialsDB = PouchDB(partialsdb + '_' + data.uid + '_year', { auto_compaction: true });
                    delete yearPower._rev;
                    partialsDB.put(yearPower).then(function () {
                        resolve(true);
                    }).catch(function (err) {
                        reject(err);
                    });
                });
            }
        }).catch(function () {
            var yearly = {
                _id: 'yearly_' + data.uid,
                dateBeginningOfYear: dateBeginningOfYear,
                power: data.yearlyEnergy,
                dateforYear: dateforYear
            };
            partialsDB.put(yearly).then(function () {
                resolve(true);
            }).catch(function (err) {
                reject(err);
            });
        });
    });
}
function each_check(data, timezone, localdb, partialsdb) {
    return new Promise(function (resolve, reject) {
        if (data.active) {
            check_day(data, timezone, localdb, partialsdb).then(function () {
                check_month(data, timezone, localdb, partialsdb).then(function () {
                    check_year(data, timezone, localdb, partialsdb).then(function () {
                        resolve(true);
                    }).catch(function () {
                        reject("year error");
                    });
                }).catch(function () {
                    check_year(data, timezone, localdb, partialsdb).then(function () {
                        reject("month error");
                    }).catch(function () {
                        reject("month and year error");
                    });
                });
            }).catch(function () {
                check_month(data, timezone, localdb, partialsdb).then(function () {
                    check_year(data, timezone, localdb, partialsdb).then(function () {
                        reject("day error");
                    }).catch(function () {
                        reject("day and year error");
                    });
                }).catch(function () {
                    check_year(data, timezone, localdb, partialsdb).then(function () {
                        reject("day and month error");
                    }).catch(function () {
                        reject("can't save partials at all");
                    });
                });
            });
        }
        else {
            resolve({ status: 'off' });
        }
    });
}
module.exports = function (data, timezone, localdb, partialsdb) {
    if (!_.isArray(data)) {
        return each_check(data, timezone, localdb, partialsdb);
    }
    else {
        var serial_check = async(function () {
            _.map(data, function (d) {
                if (d.active) {
                    var aa = await(each_check(d, timezone, localdb, partialsdb));
                }
            });
        });
        return serial_check();
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZXMvc2V0cG93ZXJwYXJ0aWFscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsSUFBWSxNQUFNLFdBQU0saUJBQWlCLENBQUMsQ0FBQTtBQUMxQyxJQUFZLE9BQU8sV0FBTSxVQUFVLENBQUMsQ0FBQTtBQUNwQyxJQUFZLENBQUMsV0FBTSxRQUFRLENBQUMsQ0FBQTtBQUc1QixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUN4QyxJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUN4QyxJQUFJLE9BQU8sR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFFakMsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQ3JDLElBQUksT0FBTyxHQUFDLE1BQU0sQ0FBQztBQUVuQixtQkFBbUIsSUFBUyxFQUFDLFFBQWUsRUFBQyxPQUFPLEVBQUMsVUFBVTtJQUM3RCxNQUFNLENBQUMsSUFBSSxPQUFPLENBQUMsVUFBVSxPQUFPLEVBQUUsTUFBTTtRQUcxQyxJQUFJLE9BQU8sR0FBQyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNqQyxJQUFJLFVBQVUsR0FBQyxPQUFPLENBQUMsVUFBVSxHQUFDLEdBQUcsR0FBQyxJQUFJLENBQUMsR0FBRyxHQUFDLE1BQU0sRUFBQyxFQUFDLGVBQWUsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDO1FBRy9FLElBQUksT0FBTyxHQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoRCxJQUFJLFNBQVMsR0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsSUFBSSxXQUFX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QztBQStDRCxpQkFBTyxVQUFTLElBQVEsRUFBQyxRQUFlLEVBQUMsT0FBTyxFQUFDLFVBQVU7SUFHdkQsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUEsQ0FBQztRQUNwQixNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksRUFBQyxRQUFRLEVBQUMsT0FBTyxFQUFDLFVBQVUsQ0FBQyxDQUFBO0lBQ3JELENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNOLElBQUksWUFBWSxHQUFHLEtBQUssQ0FBRTtZQUUxQixDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksRUFBQyxVQUFTLENBQU07Z0JBQ3hCLEVBQUUsQ0FBQSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQSxDQUFDO29CQUNiLElBQUksRUFBRSxHQUFHLEtBQUssQ0FBRSxVQUFVLENBQUMsQ0FBQyxFQUFDLFFBQVEsRUFBQyxPQUFPLEVBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztnQkFDN0QsQ0FBQztZQUNELENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDSCxNQUFNLENBQUMsWUFBWSxFQUFFLENBQUM7SUFHdEIsQ0FBQztBQUdMLENBQUMsQ0FBQSIsImZpbGUiOiJtb2R1bGVzL3NldHBvd2VycGFydGlhbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBtb21lbnQgZnJvbSAnbW9tZW50LXRpbWV6b25lJztcbmltcG9ydCAqIGFzIFByb21pc2UgZnJvbSBcImJsdWViaXJkXCI7XG5pbXBvcnQgKiBhcyBfIGZyb20gXCJsb2Rhc2hcIjtcblxuXG5sZXQgYXN5bmMgPSByZXF1aXJlKCdhc3luY2F3YWl0L2FzeW5jJyk7XG5sZXQgYXdhaXQgPSByZXF1aXJlKCdhc3luY2F3YWl0L2F3YWl0Jyk7XG5sZXQgUG91Y2hEQiA9IHJlcXVpcmUoJ3BvdWNoZGInKTtcblxubGV0IGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmYuanNvbicpO1xubGV0IGxvY2FsZGI9J2RhdGEnO1xuXG5mdW5jdGlvbiBjaGVja19kYXkoZGF0YTpJQVBJLHRpbWV6b25lOnN0cmluZyxsb2NhbGRiLHBhcnRpYWxzZGIpe1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICBsZXQgbG9jYWxEQj1uZXcgUG91Y2hEQihsb2NhbGRiKTtcbiAgICBsZXQgcGFydGlhbHNEQj1Qb3VjaERCKHBhcnRpYWxzZGIrJ18nK2RhdGEudWlkKydfZGF5Jyx7YXV0b19jb21wYWN0aW9uOiB0cnVlfSk7XG5cblxuICAgIGxldCBkYXRlRGF5PXBhcnNlSW50KGRhdGEuZGF0ZVs2XStkYXRhLmRhdGVbN10pO1xuICAgIGxldCBkYXRlTW9udGg9cGFyc2VJbnQoZGF0YS5kYXRlWzRdK2RhdGEuZGF0ZVs1XSk7XG4gICAgbGV0IGRhdGVmb3JZZWFyPXBhcnNlSW50KGRhdGEuZGF0ZVswXStkYXRhLmRhdGVbMV0rZGF0YS5kYXRlWzJdK2RhdGEuZGF0ZVszXSk7XG5cbiAgICBsZXQgZGF0ZUJlZ2lubmluZ09mRGF5PW1vbWVudC50eihkYXRlZm9yWWVhcisnICcrZGF0ZU1vbnRoKycgJytkYXRlRGF5LFwiWVlZWSBNTSBERFwiLHRpbWV6b25lKS52YWx1ZU9mKCk7XG4gICAgbGV0IGRhdGVCZWdpbm5pbmdPZk1vbnRoPW1vbWVudC50eihkYXRlZm9yWWVhcisnICcrZGF0ZU1vbnRoKycgMDEnLFwiWVlZWSBNTSBERFwiLHRpbWV6b25lKS52YWx1ZU9mKCk7XG4gICAgbGV0IGRhdGVCZWdpbm5pbmdPZlllYXI9bW9tZW50LnR6KGRhdGVmb3JZZWFyKycgMDEgMDEnLFwiWVlZWSBNTSBERFwiLHRpbWV6b25lKS52YWx1ZU9mKCk7XG5cbiAgICBsZXQgZGF0ZWZvckRheT1wYXJzZUludChkYXRlZm9yWWVhcitkYXRhLmRhdGVbNF0rZGF0YS5kYXRlWzVdK2RhdGEuZGF0ZVs2XStkYXRhLmRhdGVbN10pO1xuICAgIGxldCBkYXRlZm9yTW9udGg9cGFyc2VJbnQoZGF0ZWZvclllYXIrZGF0YS5kYXRlWzRdK2RhdGEuZGF0ZVs1XSk7XG5cblxuXG5cblxuXG5cbiAgICAgICAgcGFydGlhbHNEQi5nZXQoJ2RhaWx5XycrZGF0YS51aWQpLnRoZW4oZnVuY3Rpb24oZGF5UG93ZXIpe1xuXG5cbiAgICAgICAgICBpZiggZGF5UG93ZXIuZGF0ZUJlZ2lubmluZ09mRGF5ICE9IGRhdGVCZWdpbm5pbmdPZkRheSApe1xuXG5cblxuICAgICAgICAgICAgbGV0IGRhaWx5bmV3PXtcbiAgICAgICAgICAgICAgX2lkOidkYWlseV8nK2RhdGEudWlkKydfJytkYXlQb3dlci5kYXRlZm9yRGF5LFxuICAgICAgICAgICAgICBwb3dlcjpkYXlQb3dlci5wb3dlcixcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OmRheVBvd2VyLmRhdGVCZWdpbm5pbmdPZkRheVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbG9jYWxEQi5wdXQoZGFpbHluZXcpLnRoZW4oZnVuY3Rpb24oZG9jKXtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZG9jKVxuXG4gICAgICAgICAgICAgIGRheVBvd2VyLnBvd2VyPWRhdGEuZGFpbHlFbmVyZ3k7XG4gICAgICAgICAgICAgIGRheVBvd2VyLmRhdGVCZWdpbm5pbmdPZkRheT1kYXRlQmVnaW5uaW5nT2ZEYXk7XG4gICAgICAgICAgICAgIGRheVBvd2VyLmRhdGVmb3JEYXk9ZGF0ZWZvckRheTtcblxucGFydGlhbHNEQi5kZXN0cm95KCkudGhlbihmdW5jdGlvbigpe1xuICBsZXQgcGFydGlhbHNEQj1Qb3VjaERCKHBhcnRpYWxzZGIrJ18nK2RhdGEudWlkKydfZGF5Jyx7YXV0b19jb21wYWN0aW9uOiB0cnVlfSk7XG5cbiAgZGVsZXRlIGRheVBvd2VyLl9yZXY7XG5cbiAgICAgICAgICAgICAgcGFydGlhbHNEQi5wdXQoZGF5UG93ZXIpLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuXG4gICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLFwiZXJyb3JcIixcInNhdmUgZGFpbHlcIik7XG5cbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgfSk7XG59KTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICBkYXlQb3dlci5wb3dlcj1kYXRhLmRhaWx5RW5lcmd5O1xuICAgICAgICAgICAgZGF5UG93ZXIuZGF0ZUJlZ2lubmluZ09mRGF5PWRhdGVCZWdpbm5pbmdPZkRheTtcbiAgICAgICAgICAgIGRheVBvd2VyLmRhdGVmb3JEYXk9ZGF0ZWZvckRheTtcbiAgICAgICAgICAgIHBhcnRpYWxzREIuZGVzdHJveSgpLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgbGV0IHBhcnRpYWxzREI9UG91Y2hEQihwYXJ0aWFsc2RiKydfJytkYXRhLnVpZCsnX2RheScse2F1dG9fY29tcGFjdGlvbjogdHJ1ZX0pO1xuXG4gICAgICAgICAgICAgIGRlbGV0ZSBkYXlQb3dlci5fcmV2O1xuICAgICAgICAgICAgcGFydGlhbHNEQi5wdXQoZGF5UG93ZXIpLnRoZW4oZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLFwiZXJyb3JcIixcInNhdmUgZGFpbHkgcGFydGlhbFwiKTtcblxuICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cblxuXG5cbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKXtcbiAgICAgICAgICBsZXQgZGFpbHk9e1xuICAgICAgICAgICAgX2lkOidkYWlseV8nK2RhdGEudWlkLFxuICAgICAgICAgICAgZGF0ZUJlZ2lubmluZ09mRGF5OmRhdGVCZWdpbm5pbmdPZkRheSxcbiAgICAgICAgICAgIHBvd2VyOmRhdGEuZGFpbHlFbmVyZ3ksXG4gICAgICAgICAgICBkYXRlZm9yRGF5OmRhdGVmb3JEYXlcbiAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICBwYXJ0aWFsc0RCLnB1dChkYWlseSkudGhlbihmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycixcImVycm9yXCIsXCJzYXZlIGZpcnN0IGRhaWx5XCIpXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuXG5cblxufSk7XG59XG5mdW5jdGlvbiBjaGVja19tb250aChkYXRhOklBUEksdGltZXpvbmU6c3RyaW5nLGxvY2FsZGIscGFydGlhbHNkYil7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgIGxldCBsb2NhbERCPVBvdWNoREIobG9jYWxkYik7XG4gICAgbGV0IHBhcnRpYWxzREI9UG91Y2hEQihwYXJ0aWFsc2RiKydfJytkYXRhLnVpZCsnX21vbnRoJyx7YXV0b19jb21wYWN0aW9uOiB0cnVlfSk7XG5cbiAgICBsZXQgZGF0ZURheT1wYXJzZUludChkYXRhLmRhdGVbNl0rZGF0YS5kYXRlWzddKTtcbiAgICBsZXQgZGF0ZU1vbnRoPXBhcnNlSW50KGRhdGEuZGF0ZVs0XStkYXRhLmRhdGVbNV0pO1xuICAgIGxldCBkYXRlZm9yWWVhcj1wYXJzZUludChkYXRhLmRhdGVbMF0rZGF0YS5kYXRlWzFdK2RhdGEuZGF0ZVsyXStkYXRhLmRhdGVbM10pO1xuXG4gICAgbGV0IGRhdGVCZWdpbm5pbmdPZkRheT1tb21lbnQudHooZGF0ZWZvclllYXIrJyAnK2RhdGVNb250aCsnICcrZGF0ZURheSxcIllZWVkgTU0gRERcIix0aW1lem9uZSkudmFsdWVPZigpO1xuICAgIGxldCBkYXRlQmVnaW5uaW5nT2ZNb250aD1tb21lbnQudHooZGF0ZWZvclllYXIrJyAnK2RhdGVNb250aCsnIDAxJyxcIllZWVkgTU0gRERcIix0aW1lem9uZSkudmFsdWVPZigpO1xuICAgIGxldCBkYXRlQmVnaW5uaW5nT2ZZZWFyPW1vbWVudC50eihkYXRlZm9yWWVhcisnIDAxIDAxJyxcIllZWVkgTU0gRERcIix0aW1lem9uZSkudmFsdWVPZigpO1xuXG4gICAgbGV0IGRhdGVmb3JEYXk9cGFyc2VJbnQoZGF0ZWZvclllYXIrZGF0YS5kYXRlWzRdK2RhdGEuZGF0ZVs1XStkYXRlRGF5KTtcbiAgICBsZXQgZGF0ZWZvck1vbnRoPXBhcnNlSW50KGRhdGVmb3JZZWFyK2RhdGEuZGF0ZVs0XStkYXRhLmRhdGVbNV0pO1xuXG5cbiAgICAgICAgcGFydGlhbHNEQi5nZXQoJ21vbnRobHlfJytkYXRhLnVpZCkudGhlbihmdW5jdGlvbihtb250aFBvd2VyKXtcblxuXG4gICAgICAgICAgaWYoIG1vbnRoUG93ZXIuZGF0ZUJlZ2lubmluZ09mTW9udGggIT0gZGF0ZUJlZ2lubmluZ09mTW9udGggKXtcblxuXG5cbiAgICAgICAgICAgIGxldCBtb250aGx5bmV3PXtcbiAgICAgICAgICAgICAgX2lkOidtb250aGx5XycrZGF0YS51aWQrJ18nK21vbnRoUG93ZXIuZGF0ZWZvck1vbnRoLFxuICAgICAgICAgICAgICBwb3dlcjptb250aFBvd2VyLnBvd2VyLFxuICAgICAgICAgICAgICB1cGRhdGVkQXQ6bW9udGhQb3dlci5kYXRlQmVnaW5uaW5nT2ZNb250aFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsb2NhbERCLnB1dChtb250aGx5bmV3KS50aGVuKGZ1bmN0aW9uKGRvYyl7XG4gICAgICAgICAgICAgIG1vbnRoUG93ZXIucG93ZXI9ZGF0YS5tb250aGx5RW5lcmd5O1xuICAgICAgICAgICAgICBtb250aFBvd2VyLmRhdGVCZWdpbm5pbmdPZk1vbnRoPWRhdGVCZWdpbm5pbmdPZk1vbnRoO1xuICAgICAgICAgICAgICBtb250aFBvd2VyLmRhdGVmb3JNb250aD1kYXRlZm9yTW9udGg7XG5cblxuICAgICAgICAgICAgICBwYXJ0aWFsc0RCLmRlc3Ryb3koKS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgbGV0IHBhcnRpYWxzREI9UG91Y2hEQihwYXJ0aWFsc2RiKydfJytkYXRhLnVpZCsnX21vbnRoJyx7YXV0b19jb21wYWN0aW9uOiB0cnVlfSk7XG5cbiAgICAgICAgICAgICAgICBkZWxldGUgbW9udGhQb3dlci5fcmV2XG4gICAgICAgICAgICAgIHBhcnRpYWxzREIucHV0KG1vbnRoUG93ZXIpLnRoZW4oZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgIH0pO1xuXG5cbn0pO1xuXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgfSBlbHNle1xuICAgICAgICAgICAgbW9udGhQb3dlci5wb3dlcj1kYXRhLm1vbnRobHlFbmVyZ3k7XG4gICAgICAgICAgICBtb250aFBvd2VyLmRhdGVCZWdpbm5pbmdPZk1vbnRoPWRhdGVCZWdpbm5pbmdPZk1vbnRoO1xuICAgICAgICAgICAgbW9udGhQb3dlci5kYXRlZm9yTW9udGg9ZGF0ZWZvck1vbnRoO1xuICAgICAgICAgICAgcGFydGlhbHNEQi5kZXN0cm95KCkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBsZXQgcGFydGlhbHNEQj1Qb3VjaERCKHBhcnRpYWxzZGIrJ18nK2RhdGEudWlkKydfbW9udGgnLHthdXRvX2NvbXBhY3Rpb246IHRydWV9KTtcblxuICAgICAgICAgICAgICBkZWxldGUgbW9udGhQb3dlci5fcmV2XG4gICAgICAgICAgICBwYXJ0aWFsc0RCLnB1dChtb250aFBvd2VyKS50aGVuKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgICAgICB9XG5cblxuXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgbGV0IG1vbnRobHk9e1xuICAgICAgICAgICAgX2lkOidtb250aGx5XycrZGF0YS51aWQsXG4gICAgICAgICAgICBkYXRlQmVnaW5uaW5nT2ZNb250aDpkYXRlQmVnaW5uaW5nT2ZNb250aCxcbiAgICAgICAgICAgIHBvd2VyOmRhdGEubW9udGhseUVuZXJneSxcbiAgICAgICAgICAgIGRhdGVmb3JNb250aDpkYXRlZm9yTW9udGhcbiAgICAgICAgICB9O1xuICAgICAgICAgIHBhcnRpYWxzREIucHV0KG1vbnRobHkpLnRoZW4oZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG5cblxuXG5cbn0pXG59XG5mdW5jdGlvbiBjaGVja195ZWFyKGRhdGE6SUFQSSx0aW1lem9uZTpzdHJpbmcsbG9jYWxkYixwYXJ0aWFsc2RiKXtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBsZXQgbG9jYWxEQj1Qb3VjaERCKGxvY2FsZGIpO1xuICAgIGxldCBwYXJ0aWFsc0RCPVBvdWNoREIocGFydGlhbHNkYisnXycrZGF0YS51aWQrJ195ZWFyJyx7YXV0b19jb21wYWN0aW9uOiB0cnVlfSk7XG5cblxuXG4gICAgbGV0IGRhdGVEYXk9cGFyc2VJbnQoZGF0YS5kYXRlWzZdK2RhdGEuZGF0ZVs3XSk7XG4gICAgbGV0IGRhdGVNb250aD1wYXJzZUludChkYXRhLmRhdGVbNF0rZGF0YS5kYXRlWzVdKTtcbiAgICBsZXQgZGF0ZWZvclllYXI9cGFyc2VJbnQoZGF0YS5kYXRlWzBdK2RhdGEuZGF0ZVsxXStkYXRhLmRhdGVbMl0rZGF0YS5kYXRlWzNdKTtcblxuICAgIGxldCBkYXRlQmVnaW5uaW5nT2ZEYXk9bW9tZW50LnR6KGRhdGVmb3JZZWFyKycgJytkYXRlTW9udGgrJyAnK2RhdGVEYXksXCJZWVlZIE1NIEREXCIsdGltZXpvbmUpLnZhbHVlT2YoKTtcbiAgICBsZXQgZGF0ZUJlZ2lubmluZ09mTW9udGg9bW9tZW50LnR6KGRhdGVmb3JZZWFyKycgJytkYXRlTW9udGgrJyAwMScsXCJZWVlZIE1NIEREXCIsdGltZXpvbmUpLnZhbHVlT2YoKTtcbiAgICBsZXQgZGF0ZUJlZ2lubmluZ09mWWVhcj1tb21lbnQudHooZGF0ZWZvclllYXIrJyAwMSAwMScsXCJZWVlZIE1NIEREXCIsdGltZXpvbmUpLnZhbHVlT2YoKTtcblxuICAgIGxldCBkYXRlZm9yRGF5PXBhcnNlSW50KGRhdGVmb3JZZWFyK2RhdGEuZGF0ZVs0XStkYXRhLmRhdGVbNV0rZGF0ZURheSk7XG4gICAgbGV0IGRhdGVmb3JNb250aD1wYXJzZUludChkYXRlZm9yWWVhcitkYXRhLmRhdGVbNF0rZGF0YS5kYXRlWzVdKTtcblxuXG5cblxuICAgICAgICBwYXJ0aWFsc0RCLmdldCgneWVhcmx5XycrZGF0YS51aWQpLnRoZW4oZnVuY3Rpb24oeWVhclBvd2VyKXtcblxuXG4gICAgICAgICAgaWYoIHllYXJQb3dlci5kYXRlQmVnaW5uaW5nT2ZZZWFyICE9IGRhdGVCZWdpbm5pbmdPZlllYXIgKXtcblxuXG5cbiAgICAgICAgICAgIGxldCB5ZWFybHluZXc9e1xuICAgICAgICAgICAgICBfaWQ6J3llYXJseV8nK2RhdGEudWlkKydfJyt5ZWFyUG93ZXIuZGF0ZWZvclllYXIsXG4gICAgICAgICAgICAgIHBvd2VyOnllYXJQb3dlci5wb3dlcixcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OnllYXJQb3dlci5kYXRlQmVnaW5uaW5nT2ZZZWFyXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBsb2NhbERCLnB1dCh5ZWFybHluZXcpLnRoZW4oZnVuY3Rpb24oZG9jKXtcblxuICAgICAgICAgICAgICB5ZWFyUG93ZXIucG93ZXI9ZGF0YS55ZWFybHlFbmVyZ3k7XG4gICAgICAgICAgICAgIHllYXJQb3dlci5kYXRlQmVnaW5uaW5nT2ZZZWFyPWRhdGVCZWdpbm5pbmdPZlllYXI7XG4gICAgICAgICAgICAgIHllYXJQb3dlci5kYXRlZm9yWWVhcj1kYXRlZm9yWWVhcjtcblxuXG4gICAgICAgICAgICAgIHBhcnRpYWxzREIuZGVzdHJveSgpLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBsZXQgcGFydGlhbHNEQj1Qb3VjaERCKHBhcnRpYWxzZGIrJ18nK2RhdGEudWlkKydfeWVhcicse2F1dG9fY29tcGFjdGlvbjogdHJ1ZX0pO1xuXG4gICAgICAgICAgICAgICAgZGVsZXRlIHllYXJQb3dlci5fcmV2XG4gICAgICAgICAgICAgIHBhcnRpYWxzREIucHV0KHllYXJQb3dlcikudGhlbihmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgfSk7XG59KTtcblxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbnJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICB5ZWFyUG93ZXIucG93ZXI9ZGF0YS55ZWFybHlFbmVyZ3k7XG4gICAgICAgICAgICB5ZWFyUG93ZXIuZGF0ZUJlZ2lubmluZ09mWWVhcj1kYXRlQmVnaW5uaW5nT2ZZZWFyO1xuICAgICAgICAgICAgeWVhclBvd2VyLmRhdGVmb3JZZWFyPWRhdGVmb3JZZWFyO1xuICAgICAgICAgICAgcGFydGlhbHNEQi5kZXN0cm95KCkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBsZXQgcGFydGlhbHNEQj1Qb3VjaERCKHBhcnRpYWxzZGIrJ18nK2RhdGEudWlkKydfeWVhcicse2F1dG9fY29tcGFjdGlvbjogdHJ1ZX0pO1xuXG4gICAgICAgICAgICAgIGRlbGV0ZSB5ZWFyUG93ZXIuX3JldlxuICAgICAgICAgICAgcGFydGlhbHNEQi5wdXQoeWVhclBvd2VyKS50aGVuKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gIH0pO1xuICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKXtcbiAgICAgICAgICBsZXQgeWVhcmx5PXtcbiAgICAgICAgICAgIF9pZDoneWVhcmx5XycrZGF0YS51aWQsXG4gICAgICAgICAgICBkYXRlQmVnaW5uaW5nT2ZZZWFyOmRhdGVCZWdpbm5pbmdPZlllYXIsXG4gICAgICAgICAgICBwb3dlcjpkYXRhLnllYXJseUVuZXJneSxcbiAgICAgICAgICAgIGRhdGVmb3JZZWFyOmRhdGVmb3JZZWFyXG4gICAgICAgICAgfTtcbiAgICAgICAgICBwYXJ0aWFsc0RCLnB1dCh5ZWFybHkpLnRoZW4oZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG5cblxuXG59KVxufVxuXG5cbmZ1bmN0aW9uIGVhY2hfY2hlY2soZGF0YTpJQVBJLHRpbWV6b25lOnN0cmluZyxsb2NhbGRiLHBhcnRpYWxzZGIpe1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gIGlmIChkYXRhLmFjdGl2ZSl7XG5cblxuXG5jaGVja19kYXkoZGF0YSx0aW1lem9uZSxsb2NhbGRiLHBhcnRpYWxzZGIpLnRoZW4oZnVuY3Rpb24oKXtcblxuICBjaGVja19tb250aChkYXRhLHRpbWV6b25lLGxvY2FsZGIscGFydGlhbHNkYikudGhlbihmdW5jdGlvbigpe1xuICAgIGNoZWNrX3llYXIoZGF0YSx0aW1lem9uZSxsb2NhbGRiLHBhcnRpYWxzZGIpLnRoZW4oZnVuY3Rpb24oKXtcbnJlc29sdmUodHJ1ZSlcbiAgICB9KS5jYXRjaChmdW5jdGlvbigpe1xuICAgICAgcmVqZWN0KFwieWVhciBlcnJvclwiKTtcblxuICAgIH0pO1xuICB9KS5jYXRjaChmdW5jdGlvbigpe1xuICAgIGNoZWNrX3llYXIoZGF0YSx0aW1lem9uZSxsb2NhbGRiLHBhcnRpYWxzZGIpLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgIHJlamVjdChcIm1vbnRoIGVycm9yXCIpXG5cbiAgICB9KS5jYXRjaChmdW5jdGlvbigpe1xuICAgICAgcmVqZWN0KFwibW9udGggYW5kIHllYXIgZXJyb3JcIik7XG5cbiAgICB9KTtcbiAgfSk7XG59KS5jYXRjaChmdW5jdGlvbigpe1xuXG4gIGNoZWNrX21vbnRoKGRhdGEsdGltZXpvbmUsbG9jYWxkYixwYXJ0aWFsc2RiKS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgY2hlY2tfeWVhcihkYXRhLHRpbWV6b25lLGxvY2FsZGIscGFydGlhbHNkYikudGhlbihmdW5jdGlvbigpe1xuICAgICAgcmVqZWN0KFwiZGF5IGVycm9yXCIpO1xuXG4gICAgfSkuY2F0Y2goZnVuY3Rpb24oKXtcbiAgICAgIHJlamVjdChcImRheSBhbmQgeWVhciBlcnJvclwiKTtcblxuICAgIH0pO1xuICB9KS5jYXRjaChmdW5jdGlvbigpe1xuICAgIGNoZWNrX3llYXIoZGF0YSx0aW1lem9uZSxsb2NhbGRiLHBhcnRpYWxzZGIpLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgIHJlamVjdChcImRheSBhbmQgbW9udGggZXJyb3JcIilcblxuICAgIH0pLmNhdGNoKGZ1bmN0aW9uKCl7XG5cbiAgICAgIHJlamVjdChcImNhbid0IHNhdmUgcGFydGlhbHMgYXQgYWxsXCIpXG5cbiAgICB9KTtcbiAgfSk7XG59KTtcblxuXG4gIH0gZWxzZXtcbiAgICByZXNvbHZlKHtzdGF0dXM6J29mZid9KTtcblxuICB9XG59KVxufVxuXG5cbmludGVyZmFjZSBJc3RyaW5nIHtcbiAgICB2b2x0YWdlOiBudW1iZXI7XG4gICAgY3VycmVudDogbnVtYmVyO1xuICAgIHBvd2VyOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBJQVBJIHtcblxuICAgIF9pZDogc3RyaW5nO1xuICAgIHVpZDogc3RyaW5nO1xuICAgIGJvb3RJZDogc3RyaW5nO1xuICAgIGJvb3RUaW1lOiBudW1iZXI7XG4gICAgYWN0aXZlOiBib29sZWFuO1xuICAgIHVwZGF0ZWRBdDogbnVtYmVyO1xuICAgIGRhdGU6IHN0cmluZztcbiAgICBzdHJpbmdzOiBJc3RyaW5nW107XG4gICAgZ3JpZDoge1xuICAgICAgICB2b2x0YWdlOiBudW1iZXI7XG4gICAgICAgIGN1cnJlbnQ6IG51bWJlcjtcbiAgICAgICAgcG93ZXI6IG51bWJlcjtcbiAgICAgICAgaHo6IG51bWJlcjtcbiAgICB9O1xuICAgIERjQWNDdnJFZmY6IG51bWJlcjtcbiAgICBpbnZUZW1wOiBudW1iZXI7XG4gICAgZW52VGVtcDogbnVtYmVyO1xuICAgIGRhaWx5RW5lcmd5OiBudW1iZXI7XG4gICAgd2Vla2x5RW5lcmd5OiBudW1iZXI7XG4gICAgbGFzdDdEYXlzRW5lcmd5OiBudW1iZXI7XG4gICAgbW9udGhseUVuZXJneTogbnVtYmVyO1xuICAgIHllYXJseUVuZXJneTogbnVtYmVyO1xuICAgIHRvdGFsRW5lcmd5OiBudW1iZXI7XG4gICAgcGFydGlhbEVuZXJneTogbnVtYmVyO1xuICAgIGJ1bGtWOiBudW1iZXI7XG4gICAgYnVsa01WOiBudW1iZXI7XG4gICAgYnVsa0RDOiBudW1iZXI7XG4gICAgaXNvUmVzOiBudW1iZXI7XG4gICAgZ3JpZFZEQzogbnVtYmVyO1xuICAgIGdyaWRBdmdWOiBudW1iZXI7XG4gICAgZ3JpZERDSHo6IG51bWJlcjtcbiAgICBwZWFrTWF4OiBudW1iZXI7XG4gICAgcGVha0RheTogbnVtYmVyO1xuICAgIHBpbjFXOiBudW1iZXI7XG4gICAgcGluMlc6IG51bWJlcjtcbn1cbmV4cG9ydD1mdW5jdGlvbihkYXRhOmFueSx0aW1lem9uZTpzdHJpbmcsbG9jYWxkYixwYXJ0aWFsc2RiKXtcblxuXG4gICAgaWYgKCFfLmlzQXJyYXkoZGF0YSkpe1xuICAgICAgcmV0dXJuIGVhY2hfY2hlY2soZGF0YSx0aW1lem9uZSxsb2NhbGRiLHBhcnRpYWxzZGIpXG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBzZXJpYWxfY2hlY2sgPSBhc3luYyAoZnVuY3Rpb24gKCkge1xuXG4gICAgICBfLm1hcChkYXRhLGZ1bmN0aW9uKGQ6SUFQSSl7XG4gICAgICAgIGlmKGQuYWN0aXZlKXtcbiAgICAgICAgbGV0IGFhID0gYXdhaXQgKGVhY2hfY2hlY2soZCx0aW1lem9uZSxsb2NhbGRiLHBhcnRpYWxzZGIpKTtcbiAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBzZXJpYWxfY2hlY2soKTtcblxuXG4gICAgfVxuXG5cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
